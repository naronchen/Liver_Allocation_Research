This is the simulation base and the implementation
